/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ProjectTasks
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");

// helpers.ts
var BLOCK_BOUNDARY = /^#+\s/;
var DEBUG = true;
var ParsedLine = class {
  constructor(is_task, status_type, line_text, nesting) {
    this.is_task = is_task;
    this.status_type = status_type;
    this.line_text = line_text;
    this.nesting = nesting;
  }
};
var Helper = class {
  // Simple helper class that contains the business logic
  // of the app. This is extracted here to allow unit testing
  constructor() {
  }
  static getNestingLevel(task_marker) {
    let parts = task_marker.replaceAll("\n", "").split("-");
    return parts[0].length;
  }
  static generateRandomDigits(length) {
    const digits = "0123456789";
    let randomString = "";
    for (let i = 0; i < length; i++) {
      const randomIndex = Math.floor(Math.random() * digits.length);
      randomString += digits[randomIndex];
    }
    return randomString;
  }
  static getPrefixFromString(text, first_letters, remove_vowels) {
    text = text.replaceAll(/[#\[\]]/g, "");
    let words = text.split(/\s+/);
    text = "";
    for (let word of words) {
      if (word) {
        text = `${text}${word[0].toUpperCase()}`;
        if (!first_letters) {
          let remainder = word.slice(1);
          if (remove_vowels) {
            remainder = remainder.replaceAll(/[aeiou]/g, "");
          }
          text = `${text}${remainder}`;
        }
      }
    }
    text = text.replaceAll(" ", "");
    return text;
  }
  static clearBlockIDs(sel, automatic_tag, clear_all_tags = false) {
    let remove_id = /ðŸ†”\s[\w,]+[ \t]*/g;
    sel = sel.replaceAll(remove_id, "");
    let remove_block = /â›”\s[\w,]+[ \t]*/g;
    sel = sel.replaceAll(remove_block, "");
    if (clear_all_tags) {
      let remove_tag = new RegExp("^(\\s*-\\s\\[[ x\\-\\/]]\\s.*?)(#\\w+)(\\s+#\\w+s*)*(.*)$", "mg");
      ;
      sel = sel.replaceAll(remove_tag, "$1$4");
    } else if (automatic_tag) {
      let remove_tag = new RegExp("^(\\s*-\\s\\[[ x\\-\\/]]\\s.*)(#" + automatic_tag + ")(.*)$", "mg");
      sel = sel.replaceAll(remove_tag, "$1 $3");
    }
    return sel;
  }
  static getBlockEnd(editor) {
    let blockEnd = editor.getCursor().line;
    if (blockEnd >= editor.lineCount() - 1)
      return blockEnd + 1;
    blockEnd += 1;
    while (!BLOCK_BOUNDARY.test(editor.getLine(blockEnd))) {
      blockEnd++;
      if (blockEnd > editor.lineCount() - 1)
        return blockEnd;
    }
    return blockEnd;
  }
  static getBlockStart(editor) {
    let blockStart = editor.getCursor().line;
    if (BLOCK_BOUNDARY.test(editor.getLine(blockStart))) {
      return Math.min(editor.lineCount() - 1, blockStart + 1);
    }
    while (blockStart > 0 && !BLOCK_BOUNDARY.test(editor.getLine(blockStart - 1))) {
      blockStart--;
    }
    return blockStart;
  }
  static getAllBlockStarts(editor) {
    let blocks = [0];
    let section = /^#?\s\w+/;
    for (let line_number = 0; line_number < editor.lineCount(); line_number++) {
      if (section.test(editor.getLine(line_number))) {
        if (line_number > 0) {
          blocks.push(line_number);
        }
      }
    }
    return blocks;
  }
  static getSectionName(editor, file_name) {
    let section_start = Helper.getBlockStart(editor);
    if (section_start == 0) {
      return file_name;
    } else {
      return editor.getLine(section_start - 1);
    }
  }
  static addTaskIDs(sel, prefix, automatic_tag, parallel, use_prefix, random_id_length, sequential_start) {
    const regex = /^(\s*-\s\[[ x\-\/]\]\s)?(.*)$/mg;
    sel = Helper.clearBlockIDs(sel, automatic_tag);
    if (DEBUG)
      console.log(`Replaced ids and blocks to give: ${sel}`);
    const matches = sel.matchAll(regex);
    let lines = "";
    let first = true;
    let idx = 0;
    let nesting_ids = ["0:ERROR!"];
    let current_nesting = 0;
    let is_parallel = false;
    let this_id;
    for (const match of matches) {
      if (!first) {
        lines += "\n";
      }
      if (match[1]) {
        if (parallel) {
          let nesting_depth = Helper.getNestingLevel(match[1]);
          if (nesting_depth > current_nesting) {
            current_nesting += 1;
            is_parallel = true;
            nesting_ids.push(``);
          } else if (nesting_depth < current_nesting) {
            while (current_nesting > nesting_depth) {
              current_nesting -= 1;
              let nested = nesting_ids.pop();
              if (nested) {
                nesting_ids[nesting_ids.length - 1] += `,${nested}`;
              }
              is_parallel = current_nesting > 0;
            }
          }
        }
        let this_line;
        if (use_prefix) {
          this_id = `${prefix}${Helper.generateRandomDigits(random_id_length)}`;
        } else {
          this_id = `${prefix}${idx + sequential_start}`;
        }
        let cleaned_line = match[2].trim();
        if (cleaned_line != "")
          cleaned_line += " ";
        this_line = `${match[1]}${cleaned_line}\u{1F194} ${this_id}`;
        if (idx > 0) {
          if (is_parallel) {
            this_line += ` \u26D4 ${nesting_ids[current_nesting - 1]}`;
          } else {
            this_line += ` \u26D4 ${nesting_ids[nesting_ids.length - 1]}`;
          }
        }
        if (automatic_tag) {
          this_line += ` #${automatic_tag}`;
        }
        lines += this_line;
        idx += 1;
        if (is_parallel) {
          if (nesting_ids[nesting_ids.length - 1])
            nesting_ids[nesting_ids.length - 1] += ",";
          nesting_ids[nesting_ids.length - 1] += `${this_id}`;
        } else {
          nesting_ids[nesting_ids.length - 1] = this_id;
        }
        if (DEBUG)
          console.log(`Nesting level ${current_nesting}, ids ${nesting_ids}`);
      } else {
        lines += `${match[2]}`;
      }
      first = false;
    }
    return lines;
  }
  static parseLine(line) {
    const regex = /^(\s*-\s\[([ x\-\/])\]\s)?(.*)$/;
    let match = regex.exec(line);
    if (match) {
      if (match[1]) {
        return new ParsedLine(true, match[2], match[3], this.getNestingLevel(line));
      } else {
        return new ParsedLine(false, "", match[3], 0);
      }
    } else {
      throw new Error(`Line was not understood: "${line}"`);
    }
  }
};

// main.ts
var DEBUG2 = true;
var DEFAULT_SETTINGS = {
  idPrefixMethod: "1" /* UsePrefix */,
  projectPrefix: "prj",
  randomIDLength: 6,
  sequentialStartNumber: 1,
  removeVowels: false,
  firstLettersOfWords: false,
  automaticTagName: "Project",
  nestedTaskBehavior: "1" /* ParallelExecution */
};
var ProjectTasks = class extends import_obsidian.Plugin {
  async onload() {
    if (DEBUG2)
      console.log("Project Tasks starting");
    await this.loadSettings();
    this.addCommand({
      id: "set-ids",
      name: "Set project ids on Selection",
      editorCallback: (editor, view) => {
        let sel = editor.getSelection();
        let lines = Helper.addTaskIDs(
          sel,
          this.getPrefix(editor, view),
          this.settings.automaticTagName,
          this.settings.nestedTaskBehavior == "1" /* ParallelExecution */,
          this.settings.idPrefixMethod == "1" /* UsePrefix */,
          this.settings.randomIDLength,
          this.settings.sequentialStartNumber
        );
        editor.replaceSelection(
          `${lines}`
        );
      }
    });
    this.addCommand({
      id: "clear-ids",
      name: "Clear project ids on Selection",
      editorCallback: (editor, view) => {
        let sel = editor.getSelection();
        let lines = Helper.clearBlockIDs(sel, this.settings.automaticTagName);
        editor.replaceSelection(
          `${lines}`
        );
      }
    });
    this.addCommand({
      id: "set-ids-block",
      name: "Set project ids on Block",
      editorCallback: (editor, view) => {
        this.blockUpdate(editor, this.getPrefix(editor, view), true);
      }
    });
    this.addCommand({
      id: "clear-ids-block",
      name: "Clear project ids on Block",
      editorCallback: (editor, view) => {
        this.blockUpdate(editor, this.getPrefix(editor, view), false);
      }
    });
    this.addCommand({
      id: "add-project-task-list",
      name: "Add active project task list",
      editorCallback: (editor, view) => {
        this.addActiveProjectList(editor);
      }
    });
    this.addCommand({
      id: "clear-ids-file",
      name: "Clear project ids in entire file",
      editorCallback: (editor, view) => {
        let last_line = editor.lineCount();
        let range_from = { line: 0, ch: 0 };
        let range_to = { line: last_line, ch: editor.getLine(last_line).length };
        let sel = editor.getRange(range_from, range_to);
        let lines = Helper.clearBlockIDs(sel, this.settings.automaticTagName);
        editor.replaceRange(
          `${lines}`,
          range_from,
          range_to
        );
      }
    });
    this.addSettingTab(new ProjectTasksSettingsTab(this.app, this));
  }
  addActiveProjectList(editor) {
    const active_tasks_view = `\`\`\`tasks
tags includes #${this.settings.automaticTagName}
not done
hide backlink
is not blocked
\`\`\``;
    editor.replaceSelection(active_tasks_view);
  }
  blockUpdate(editor, prefix, add_ids) {
    const cursor = editor.getCursor();
    const line = editor.getLine(cursor.line);
    let blockStart = Helper.getBlockStart(editor);
    let blockEnd = Helper.getBlockEnd(editor);
    let last_line_length = editor.getLine(blockEnd + 1).length;
    const blockContent = editor.getRange({ line: blockStart, ch: 0 }, { line: blockEnd, ch: last_line_length });
    if (DEBUG2)
      console.log(`Start ${blockStart}, End ${blockEnd}, last length ${last_line_length}
Orig: ${blockContent}`);
    let lines;
    if (add_ids) {
      lines = Helper.addTaskIDs(
        blockContent,
        prefix,
        this.settings.automaticTagName,
        this.settings.nestedTaskBehavior == "1" /* ParallelExecution */,
        this.settings.idPrefixMethod == "1" /* UsePrefix */,
        this.settings.randomIDLength,
        this.settings.sequentialStartNumber
      );
    } else {
      lines = Helper.clearBlockIDs(blockContent, this.settings.automaticTagName);
    }
    if (DEBUG2)
      console.log(`Start ${blockStart}, End ${blockEnd}, last length ${last_line_length}
Orig: ${blockContent}
New: ${lines}`);
    editor.replaceRange(lines, { line: blockStart, ch: 0 }, { line: blockEnd, ch: last_line_length });
  }
  getPrefix(editor, view) {
    let raw_prefix;
    switch (this.settings.idPrefixMethod) {
      case "1" /* UsePrefix */: {
        raw_prefix = this.settings.projectPrefix;
        break;
      }
      case "3" /* FileName */: {
        raw_prefix = this.getFilename(view);
        break;
      }
      case "2" /* SectionName */: {
        raw_prefix = Helper.getSectionName(editor, this.getFilename(view));
      }
    }
    return Helper.getPrefixFromString(raw_prefix, this.settings.firstLettersOfWords, this.settings.removeVowels);
  }
  getFilename(view) {
    var _a;
    if (!((_a = view.file) == null ? void 0 : _a.name)) {
      return this.settings.projectPrefix;
    } else {
      return view.file.name.split(".")[0];
    }
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var ProjectTasksSettingsTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Project ID method").setDesc("Choose how the ID will be determined").addDropdown((dropDown) => {
      dropDown.addOption("1", "Use prefix");
      dropDown.addOption("2", "Use Section name");
      dropDown.addOption("3", "Use filename").setValue(this.plugin.settings.idPrefixMethod).onChange(async (value) => {
        this.plugin.settings.idPrefixMethod = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Project ID prefix").setDesc("Prefix to use when creating an ID for a task").addText((text) => text.setPlaceholder("ID prefix").setValue(this.plugin.settings.projectPrefix).onChange(async (value) => {
      this.plugin.settings.projectPrefix = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Length of random ID number").setDesc("How many digits to use for random ID when using a fixed prefix").addSlider((text) => text.setValue(this.plugin.settings.randomIDLength).setLimits(3, 6, 1).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.randomIDLength = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Initial sequential ID number").setDesc("Start number for sequential ID's").addSlider((text) => text.setValue(this.plugin.settings.sequentialStartNumber).setLimits(0, 1, 1).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.sequentialStartNumber = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Remove vowels").setDesc("Remove vowels from the prefix when getting from the filename or block name").addToggle((text) => text.setValue(this.plugin.settings.removeVowels).onChange(async (value) => {
      this.plugin.settings.removeVowels = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("First letter of words").setDesc("Only use the first letter of words to form the prefix").addToggle((text) => text.setValue(this.plugin.settings.firstLettersOfWords).onChange(async (value) => {
      this.plugin.settings.firstLettersOfWords = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Automatically add Tag").setDesc("A tag to add to each task - do not include the # symbol").addText((text) => text.setValue(this.plugin.settings.automaticTagName).setPlaceholder("Tag Name").onChange(async (value) => {
      this.plugin.settings.automaticTagName = value.replaceAll("#", "");
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Nested tags behaviour").setDesc("Determines whether nested tags will create parallel execution tags or sequential").addDropdown((dropDown) => {
      dropDown.addOption("1", "Parallel Execution");
      dropDown.addOption("2", "Sequential Execution").setValue(this.plugin.settings.nestedTaskBehavior).onChange(async (value) => {
        this.plugin.settings.nestedTaskBehavior = value;
        await this.plugin.saveSettings();
      });
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJoZWxwZXJzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQge1xuICAgIEFwcCxcbiAgICBFZGl0b3IsXG4gICAgRWRpdG9yUG9zaXRpb24sIE1hcmtkb3duRmlsZUluZm8sXG4gICAgTWFya2Rvd25WaWV3LFxuICAgIE1vZGFsLFxuICAgIE5vdGljZSxcbiAgICBQbHVnaW4sXG4gICAgUGx1Z2luU2V0dGluZ1RhYixcbiAgICBTZXR0aW5nLFxuICAgIFZpZXdcbn0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0ICogYXMgbmV0IGZyb20gXCJuZXRcIjtcbmltcG9ydCBIZWxwZXIgZnJvbSBcIi4vaGVscGVyc1wiO1xuXG4vLyBUdXJuIG9uIHRvIGFsbG93IGRlYnVnZ2luZyBpbiB0aGUgY29uc29sZVxuY29uc3QgREVCVUcgPSB0cnVlO1xuXG4vLyBSZWdleCBmb3IgYmxvY2sgYm91bmRhcnlcbi8vIFRvRG8gLSB0aGlzIGlzIGR1cGxpY2F0ZWQgaW4gdGhlIEhlbHBlciBjbGFzcywgc2hvdWxkIHJlZmFjdG9yIHRoaXNcbmNvbnN0IEJMT0NLX0JPVU5EQVJZID0gL14jK1xccy87XG5cblxuZW51bSBQcmVmaXhNZXRob2Qge1xuICAgIFVzZVByZWZpeCA9ICcxJyxcbiAgICBTZWN0aW9uTmFtZSA9ICcyJyxcbiAgICBGaWxlTmFtZSA9ICczJ1xufVxuXG5lbnVtIE5lc3RpbmdCZWhhdmlvdXIge1xuICAgIFBhcmFsbGVsRXhlY3V0aW9uID0gJzEnLFxuICAgIFNlcXVlbnRpYWxFeGVjdXRpb24gPSAnMicsXG59XG5cbmludGVyZmFjZSBQcm9qZWN0VGFza3NTZXR0aW5ncyB7XG4gICAgaWRQcmVmaXhNZXRob2Q6IFByZWZpeE1ldGhvZDtcbiAgICBwcm9qZWN0UHJlZml4OiBzdHJpbmc7XG4gICAgcmFuZG9tSURMZW5ndGg6IG51bWJlcjtcbiAgICBzZXF1ZW50aWFsU3RhcnROdW1iZXI6IG51bWJlcjtcbiAgICByZW1vdmVWb3dlbHM6IGJvb2xlYW47XG4gICAgZmlyc3RMZXR0ZXJzT2ZXb3JkczogYm9vbGVhbjtcbiAgICBhdXRvbWF0aWNUYWdOYW1lOiBzdHJpbmc7XG4gICAgbmVzdGVkVGFza0JlaGF2aW9yOiBOZXN0aW5nQmVoYXZpb3VyO1xuXG59XG5cbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFByb2plY3RUYXNrc1NldHRpbmdzID0ge1xuICAgIGlkUHJlZml4TWV0aG9kOiBQcmVmaXhNZXRob2QuVXNlUHJlZml4LFxuICAgIHByb2plY3RQcmVmaXg6ICdwcmonLFxuICAgIHJhbmRvbUlETGVuZ3RoOiA2LFxuICAgIHNlcXVlbnRpYWxTdGFydE51bWJlcjogMSxcbiAgICByZW1vdmVWb3dlbHM6IGZhbHNlLFxuICAgIGZpcnN0TGV0dGVyc09mV29yZHM6IGZhbHNlLFxuICAgIGF1dG9tYXRpY1RhZ05hbWU6IFwiUHJvamVjdFwiLFxuICAgIG5lc3RlZFRhc2tCZWhhdmlvcjogTmVzdGluZ0JlaGF2aW91ci5QYXJhbGxlbEV4ZWN1dGlvbixcbn1cblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQcm9qZWN0VGFza3MgZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBQcm9qZWN0VGFza3NTZXR0aW5ncztcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmxvZygnUHJvamVjdCBUYXNrcyBzdGFydGluZycpO1xuXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcInNldC1pZHNcIixcbiAgICAgICAgICAgIG5hbWU6IFwiU2V0IHByb2plY3QgaWRzIG9uIFNlbGVjdGlvblwiLFxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3IsIHZpZXcpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgc2VsID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGxldCBsaW5lcyA9IEhlbHBlci5hZGRUYXNrSURzKHNlbCwgdGhpcy5nZXRQcmVmaXgoZWRpdG9yLCB2aWV3KSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5hdXRvbWF0aWNUYWdOYW1lLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLm5lc3RlZFRhc2tCZWhhdmlvciA9PSBOZXN0aW5nQmVoYXZpb3VyLlBhcmFsbGVsRXhlY3V0aW9uLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmlkUHJlZml4TWV0aG9kID09IFByZWZpeE1ldGhvZC5Vc2VQcmVmaXgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MucmFuZG9tSURMZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Muc2VxdWVudGlhbFN0YXJ0TnVtYmVyXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVNlbGVjdGlvbihcbiAgICAgICAgICAgICAgICAgICAgYCR7bGluZXN9YFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogXCJjbGVhci1pZHNcIixcbiAgICAgICAgICAgIG5hbWU6IFwiQ2xlYXIgcHJvamVjdCBpZHMgb24gU2VsZWN0aW9uXCIsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvciwgdmlldykgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBzZWwgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgbGV0IGxpbmVzID0gSGVscGVyLmNsZWFyQmxvY2tJRHMoc2VsLCB0aGlzLnNldHRpbmdzLmF1dG9tYXRpY1RhZ05hbWUpO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKFxuICAgICAgICAgICAgICAgICAgICBgJHtsaW5lc31gXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcInNldC1pZHMtYmxvY2tcIixcbiAgICAgICAgICAgIG5hbWU6IFwiU2V0IHByb2plY3QgaWRzIG9uIEJsb2NrXCIsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvciwgdmlldykgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYmxvY2tVcGRhdGUoZWRpdG9yLCB0aGlzLmdldFByZWZpeChlZGl0b3IsIHZpZXcpLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwiY2xlYXItaWRzLWJsb2NrXCIsXG4gICAgICAgICAgICBuYW1lOiBcIkNsZWFyIHByb2plY3QgaWRzIG9uIEJsb2NrXCIsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvciwgdmlldykgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYmxvY2tVcGRhdGUoZWRpdG9yLCB0aGlzLmdldFByZWZpeChlZGl0b3IsIHZpZXcpLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcImFkZC1wcm9qZWN0LXRhc2stbGlzdFwiLFxuICAgICAgICAgICAgbmFtZTogXCJBZGQgYWN0aXZlIHByb2plY3QgdGFzayBsaXN0XCIsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvciwgdmlldykgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQWN0aXZlUHJvamVjdExpc3QoZWRpdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwiY2xlYXItaWRzLWZpbGVcIixcbiAgICAgICAgICAgIG5hbWU6IFwiQ2xlYXIgcHJvamVjdCBpZHMgaW4gZW50aXJlIGZpbGVcIixcbiAgICAgICAgICAgIGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yLCB2aWV3KSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGxhc3RfbGluZSA9IGVkaXRvci5saW5lQ291bnQoKVxuICAgICAgICAgICAgICAgIGxldCByYW5nZV9mcm9tID0ge2xpbmU6IDAsIGNoOiAwfVxuICAgICAgICAgICAgICAgIGxldCByYW5nZV90byA9IHtsaW5lOiBsYXN0X2xpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShsYXN0X2xpbmUpLmxlbmd0aH1cbiAgICAgICAgICAgICAgICBsZXQgc2VsID0gZWRpdG9yLmdldFJhbmdlKHJhbmdlX2Zyb20sIHJhbmdlX3RvKTtcbiAgICAgICAgICAgICAgICBsZXQgbGluZXMgPSBIZWxwZXIuY2xlYXJCbG9ja0lEcyhzZWwsIHRoaXMuc2V0dGluZ3MuYXV0b21hdGljVGFnTmFtZSk7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShcbiAgICAgICAgICAgICAgICAgICAgYCR7bGluZXN9YCxcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2VfZnJvbSxcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2VfdG9cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIC8vIFRoaXMgYWRkcyBhIHNldHRpbmdzIHRhYiBzbyB0aGUgdXNlciBjYW4gY29uZmlndXJlIHZhcmlvdXMgYXNwZWN0cyBvZiB0aGUgcGx1Z2luXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgUHJvamVjdFRhc2tzU2V0dGluZ3NUYWIodGhpcy5hcHAsIHRoaXMpKTtcblxuICAgIH1cblxuICAgIGFkZEFjdGl2ZVByb2plY3RMaXN0KGVkaXRvcjogRWRpdG9yKSB7XG4gICAgICAgIC8vIEEgdmlldyB0byBzaG93IGFjdGl2ZSB0YXNrc1xuICAgICAgICBjb25zdCBhY3RpdmVfdGFza3NfdmlldyA9IGBcXGBcXGBcXGB0YXNrc1xudGFncyBpbmNsdWRlcyAjJHt0aGlzLnNldHRpbmdzLmF1dG9tYXRpY1RhZ05hbWV9XG5ub3QgZG9uZVxuaGlkZSBiYWNrbGlua1xuaXMgbm90IGJsb2NrZWRcblxcYFxcYFxcYGA7XG4gICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKGFjdGl2ZV90YXNrc192aWV3KTtcbiAgICB9XG5cbiAgICBibG9ja1VwZGF0ZShlZGl0b3I6IEVkaXRvciwgcHJlZml4OiBzdHJpbmcsIGFkZF9pZHM6IGJvb2xlYW4pIHtcbiAgICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICBjb25zdCBsaW5lID0gZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpO1xuXG4gICAgICAgIC8vIEdldCB0aGUgYmxvY2sgYm91bmRhcmllc1xuICAgICAgICBsZXQgYmxvY2tTdGFydCA9IEhlbHBlci5nZXRCbG9ja1N0YXJ0KGVkaXRvcik7XG4gICAgICAgIGxldCBibG9ja0VuZCA9IEhlbHBlci5nZXRCbG9ja0VuZChlZGl0b3IpO1xuICAgICAgICBsZXQgbGFzdF9saW5lX2xlbmd0aCA9IGVkaXRvci5nZXRMaW5lKGJsb2NrRW5kICsgMSkubGVuZ3RoO1xuXG4gICAgICAgIGNvbnN0IGJsb2NrQ29udGVudCA9IGVkaXRvci5nZXRSYW5nZSh7bGluZTogYmxvY2tTdGFydCwgY2g6IDB9LCB7bGluZTogYmxvY2tFbmQsIGNoOiBsYXN0X2xpbmVfbGVuZ3RofSk7XG4gICAgICAgIGlmIChERUJVRykgY29uc29sZS5sb2coYFN0YXJ0ICR7YmxvY2tTdGFydH0sIEVuZCAke2Jsb2NrRW5kfSwgbGFzdCBsZW5ndGggJHtsYXN0X2xpbmVfbGVuZ3RofVxcbk9yaWc6ICR7YmxvY2tDb250ZW50fWApO1xuXG4gICAgICAgIGxldCBsaW5lcztcbiAgICAgICAgaWYgKGFkZF9pZHMpIHtcbiAgICAgICAgICAgIGxpbmVzID0gSGVscGVyLmFkZFRhc2tJRHMoYmxvY2tDb250ZW50LCBwcmVmaXgsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuYXV0b21hdGljVGFnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5uZXN0ZWRUYXNrQmVoYXZpb3IgPT0gTmVzdGluZ0JlaGF2aW91ci5QYXJhbGxlbEV4ZWN1dGlvbixcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5pZFByZWZpeE1ldGhvZCA9PSBQcmVmaXhNZXRob2QuVXNlUHJlZml4LFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLnJhbmRvbUlETGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLnNlcXVlbnRpYWxTdGFydE51bWJlclxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxpbmVzID0gSGVscGVyLmNsZWFyQmxvY2tJRHMoYmxvY2tDb250ZW50LCB0aGlzLnNldHRpbmdzLmF1dG9tYXRpY1RhZ05hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmxvZyhgU3RhcnQgJHtibG9ja1N0YXJ0fSwgRW5kICR7YmxvY2tFbmR9LCBsYXN0IGxlbmd0aCAke2xhc3RfbGluZV9sZW5ndGh9XFxuT3JpZzogJHtibG9ja0NvbnRlbnR9XFxuTmV3OiAke2xpbmVzfWApO1xuICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKGxpbmVzLCB7bGluZTogYmxvY2tTdGFydCwgY2g6IDB9LCB7bGluZTogYmxvY2tFbmQsIGNoOiBsYXN0X2xpbmVfbGVuZ3RofSk7XG4gICAgfVxuXG4gICAgZ2V0UHJlZml4KGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93bkZpbGVJbmZvKSB7XG4gICAgICAgIGxldCByYXdfcHJlZml4O1xuICAgICAgICBzd2l0Y2ggKHRoaXMuc2V0dGluZ3MuaWRQcmVmaXhNZXRob2QpIHtcbiAgICAgICAgICAgIGNhc2UgUHJlZml4TWV0aG9kLlVzZVByZWZpeDoge1xuICAgICAgICAgICAgICAgIHJhd19wcmVmaXggPSB0aGlzLnNldHRpbmdzLnByb2plY3RQcmVmaXg7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFByZWZpeE1ldGhvZC5GaWxlTmFtZToge1xuICAgICAgICAgICAgICAgIHJhd19wcmVmaXggPSB0aGlzLmdldEZpbGVuYW1lKHZpZXcpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBQcmVmaXhNZXRob2QuU2VjdGlvbk5hbWU6IHtcbiAgICAgICAgICAgICAgICAvLyBUcnkgdG8gZmluZCB0aGUgbmFtZSBvZiB0aGUgYmxvY2sgdGhhdCBjb250YWlucyB0aGUgY3Vyc29yIG9yIHRoZSBzZWxlY3Rpb25cbiAgICAgICAgICAgICAgICByYXdfcHJlZml4ID0gSGVscGVyLmdldFNlY3Rpb25OYW1lKGVkaXRvciwgdGhpcy5nZXRGaWxlbmFtZSh2aWV3KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEhlbHBlci5nZXRQcmVmaXhGcm9tU3RyaW5nKHJhd19wcmVmaXgsIHRoaXMuc2V0dGluZ3MuZmlyc3RMZXR0ZXJzT2ZXb3JkcywgdGhpcy5zZXR0aW5ncy5yZW1vdmVWb3dlbHMpO1xuICAgIH1cblxuICAgIGdldEZpbGVuYW1lKHZpZXc6IE1hcmtkb3duRmlsZUluZm8pIHtcbiAgICAgICAgaWYgKCF2aWV3LmZpbGU/Lm5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLnByb2plY3RQcmVmaXg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdmlldy5maWxlLm5hbWUuc3BsaXQoJy4nKVswXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9udW5sb2FkKCkge1xuXG4gICAgfVxuXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gICAgfVxufVxuXG5cbmNsYXNzIFByb2plY3RUYXNrc1NldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBQcm9qZWN0VGFza3M7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBQcm9qZWN0VGFza3MpIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7Y29udGFpbmVyRWx9ID0gdGhpcztcblxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1Byb2plY3QgSUQgbWV0aG9kJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdDaG9vc2UgaG93IHRoZSBJRCB3aWxsIGJlIGRldGVybWluZWQnKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3BEb3duID0+IHtcbiAgICAgICAgICAgICAgICBkcm9wRG93bi5hZGRPcHRpb24oJzEnLCAnVXNlIHByZWZpeCcpO1xuICAgICAgICAgICAgICAgIGRyb3BEb3duLmFkZE9wdGlvbignMicsICdVc2UgU2VjdGlvbiBuYW1lJyk7XG4gICAgICAgICAgICAgICAgZHJvcERvd24uYWRkT3B0aW9uKCczJywgJ1VzZSBmaWxlbmFtZScpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5pZFByZWZpeE1ldGhvZClcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaWRQcmVmaXhNZXRob2QgPSB2YWx1ZSBhcyBQcmVmaXhNZXRob2Q7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1Byb2plY3QgSUQgcHJlZml4JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdQcmVmaXggdG8gdXNlIHdoZW4gY3JlYXRpbmcgYW4gSUQgZm9yIGEgdGFzaycpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ0lEIHByZWZpeCcpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnByb2plY3RQcmVmaXgpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9qZWN0UHJlZml4ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdMZW5ndGggb2YgcmFuZG9tIElEIG51bWJlcicpXG4gICAgICAgICAgICAuc2V0RGVzYygnSG93IG1hbnkgZGlnaXRzIHRvIHVzZSBmb3IgcmFuZG9tIElEIHdoZW4gdXNpbmcgYSBmaXhlZCBwcmVmaXgnKVxuICAgICAgICAgICAgLmFkZFNsaWRlcih0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucmFuZG9tSURMZW5ndGgpXG4gICAgICAgICAgICAgICAgLnNldExpbWl0cygzLCA2LCAxKVxuICAgICAgICAgICAgICAgIC5zZXREeW5hbWljVG9vbHRpcCgpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yYW5kb21JRExlbmd0aCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnSW5pdGlhbCBzZXF1ZW50aWFsIElEIG51bWJlcicpXG4gICAgICAgICAgICAuc2V0RGVzYygnU3RhcnQgbnVtYmVyIGZvciBzZXF1ZW50aWFsIElEXFwncycpXG4gICAgICAgICAgICAuYWRkU2xpZGVyKHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXF1ZW50aWFsU3RhcnROdW1iZXIpXG4gICAgICAgICAgICAgICAgLnNldExpbWl0cygwLCAxLCAxKVxuICAgICAgICAgICAgICAgIC5zZXREeW5hbWljVG9vbHRpcCgpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXF1ZW50aWFsU3RhcnROdW1iZXIgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1JlbW92ZSB2b3dlbHMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1JlbW92ZSB2b3dlbHMgZnJvbSB0aGUgcHJlZml4IHdoZW4gZ2V0dGluZyBmcm9tIHRoZSBmaWxlbmFtZSBvciBibG9jayBuYW1lJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZVZvd2VscylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZVZvd2VscyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRmlyc3QgbGV0dGVyIG9mIHdvcmRzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdPbmx5IHVzZSB0aGUgZmlyc3QgbGV0dGVyIG9mIHdvcmRzIHRvIGZvcm0gdGhlIHByZWZpeCcpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5maXJzdExldHRlcnNPZldvcmRzKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlyc3RMZXR0ZXJzT2ZXb3JkcyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnQXV0b21hdGljYWxseSBhZGQgVGFnJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdBIHRhZyB0byBhZGQgdG8gZWFjaCB0YXNrIC0gZG8gbm90IGluY2x1ZGUgdGhlICMgc3ltYm9sJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvbWF0aWNUYWdOYW1lKVxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIlRhZyBOYW1lXCIpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvbWF0aWNUYWdOYW1lID0gdmFsdWUucmVwbGFjZUFsbCgnIycsICcnKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ05lc3RlZCB0YWdzIGJlaGF2aW91cicpXG4gICAgICAgICAgICAuc2V0RGVzYygnRGV0ZXJtaW5lcyB3aGV0aGVyIG5lc3RlZCB0YWdzIHdpbGwgY3JlYXRlIHBhcmFsbGVsIGV4ZWN1dGlvbiB0YWdzIG9yIHNlcXVlbnRpYWwnKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3BEb3duID0+IHtcbiAgICAgICAgICAgICAgICBkcm9wRG93bi5hZGRPcHRpb24oJzEnLCAnUGFyYWxsZWwgRXhlY3V0aW9uJyk7XG4gICAgICAgICAgICAgICAgZHJvcERvd24uYWRkT3B0aW9uKCcyJywgJ1NlcXVlbnRpYWwgRXhlY3V0aW9uJylcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm5lc3RlZFRhc2tCZWhhdmlvcilcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubmVzdGVkVGFza0JlaGF2aW9yID0gdmFsdWUgYXMgTmVzdGluZ0JlaGF2aW91cjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgfVxufVxuXG4iLCAiaW1wb3J0IHtFZGl0b3J9IGZyb20gXCJvYnNpZGlhblwiO1xuXG4vLyBSZWdleCBmb3IgYmxvY2sgYm91bmRhcnlcbmNvbnN0IEJMT0NLX0JPVU5EQVJZID0gL14jK1xccy87XG5jb25zdCBERUJVRyA9IHRydWU7XG5cbmludGVyZmFjZSBTaW1wbGVDdXJzb3Ige1xuICAgIGxpbmU6IG51bWJlclxufVxuXG5pbnRlcmZhY2UgU2ltcGxlRWRpdG9yIHtcbiAgICAvLyBUaGlzIGludGVyZmFjZSBpcyBjcmVhdGVkIHRvIGhlbHAgd2l0aCB0aGUgZnVuY3Rpb25zIGhlcmUgdGhhdCBuZWVkIHRoZSBPYnNpZGlhbiBFZGl0b3JcbiAgICBnZXRDdXJzb3IoKTogU2ltcGxlQ3Vyc29yO1xuICAgIGdldExpbmUobjogbnVtYmVyKTogc3RyaW5nO1xuICAgIGxpbmVDb3VudCgpOiBudW1iZXJcbn1cblxuY2xhc3MgUGFyc2VkTGluZSB7XG4gICAgaXNfdGFzazogYm9vbGVhbjtcbiAgICBzdGF0dXNfdHlwZTogc3RyaW5nO1xuICAgIGxpbmVfdGV4dDogc3RyaW5nO1xuICAgIG5lc3Rpbmc6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKGlzX3Rhc2s6IGJvb2xlYW4sIHN0YXR1c190eXBlOiBzdHJpbmcsIGxpbmVfdGV4dDogc3RyaW5nLCBuZXN0aW5nOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5pc190YXNrID0gaXNfdGFzaztcbiAgICAgICAgdGhpcy5zdGF0dXNfdHlwZSA9IHN0YXR1c190eXBlO1xuICAgICAgICB0aGlzLmxpbmVfdGV4dCA9IGxpbmVfdGV4dDtcbiAgICAgICAgdGhpcy5uZXN0aW5nID0gbmVzdGluZztcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEhlbHBlciB7XG4gICAgLy8gU2ltcGxlIGhlbHBlciBjbGFzcyB0aGF0IGNvbnRhaW5zIHRoZSBidXNpbmVzcyBsb2dpY1xuICAgIC8vIG9mIHRoZSBhcHAuIFRoaXMgaXMgZXh0cmFjdGVkIGhlcmUgdG8gYWxsb3cgdW5pdCB0ZXN0aW5nXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgfVxuXG4gICAgc3RhdGljIGdldE5lc3RpbmdMZXZlbCh0YXNrX21hcmtlcjogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAgICAgLy8gVGhlIG5lc3RpbmcgbGV2ZWwgaXMgdGhlIG51bWJlciBvZiBzcGFjZXMgYmVmb3JlIHRoZSBmaXJzdCBcIi1cIiBjaGFyYWN0ZXJcbiAgICAgICAgbGV0IHBhcnRzID0gdGFza19tYXJrZXIucmVwbGFjZUFsbChcIlxcblwiLCBcIlwiKS5zcGxpdChcIi1cIik7XG4gICAgICAgIHJldHVybiBwYXJ0c1swXS5sZW5ndGg7XG4gICAgfVxuXG4gICAgc3RhdGljIGdlbmVyYXRlUmFuZG9tRGlnaXRzKGxlbmd0aDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICAgIGNvbnN0IGRpZ2l0cyA9ICcwMTIzNDU2Nzg5JztcbiAgICAgIGxldCByYW5kb21TdHJpbmcgPSAnJztcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGRpZ2l0cy5sZW5ndGgpO1xuICAgICAgICByYW5kb21TdHJpbmcgKz0gZGlnaXRzW3JhbmRvbUluZGV4XTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJhbmRvbVN0cmluZztcbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0UHJlZml4RnJvbVN0cmluZyh0ZXh0OiBzdHJpbmcsIGZpcnN0X2xldHRlcnM6IGJvb2xlYW4sIHJlbW92ZV92b3dlbHM6IGJvb2xlYW4pIHtcbiAgICAgICAgLy8gUmVtb3ZlIGFueSBzcGVjaWFsIHNpZ25zXG4gICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2VBbGwoL1sjXFxbXFxdXS9nLCAnJyk7XG4gICAgICAgIC8vIEJyZWFrIGludG8gd29yZHNcbiAgICAgICAgbGV0IHdvcmRzID0gdGV4dC5zcGxpdCgvXFxzKy8pO1xuICAgICAgICB0ZXh0ID0gXCJcIjtcbiAgICAgICAgZm9yIChsZXQgd29yZCBvZiB3b3Jkcykge1xuICAgICAgICAgICAgaWYgKHdvcmQpIHtcbiAgICAgICAgICAgICAgICB0ZXh0ID0gYCR7dGV4dH0ke3dvcmRbMF0udG9VcHBlckNhc2UoKX1gO1xuICAgICAgICAgICAgICAgIGlmICghZmlyc3RfbGV0dGVycykge1xuICAgICAgICAgICAgICAgICAgICBsZXQgcmVtYWluZGVyID0gd29yZC5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHZvd2VscyBpZiBuZWVkZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW92ZV92b3dlbHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbWFpbmRlciA9IHJlbWFpbmRlci5yZXBsYWNlQWxsKC9bYWVpb3VdL2csICcnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gYCR7dGV4dH0ke3JlbWFpbmRlcn1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBSZW1vdmUgc3BhY2VzXG4gICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2VBbGwoJyAnLCAnJyk7XG4gICAgICAgIHJldHVybiB0ZXh0O1xuICAgIH1cblxuICAgIHN0YXRpYyBjbGVhckJsb2NrSURzKHNlbDogc3RyaW5nLCBhdXRvbWF0aWNfdGFnOiBzdHJpbmcsIGNsZWFyX2FsbF90YWdzOiBib29sZWFuID0gZmFsc2UpIHtcbiAgICAgICAgLy8gUmVtb3ZlIGV4aXN0aW5nIElEJ3NcbiAgICAgICAgbGV0IHJlbW92ZV9pZCA9IC9cdUQ4M0NcdUREOTRcXHNbXFx3LF0rWyBcXHRdKi9nO1xuICAgICAgICBzZWwgPSBzZWwucmVwbGFjZUFsbChyZW1vdmVfaWQsICcnKTtcblxuICAgICAgICAvLyBSZW1vdmUgZXhpc3RpbmcgQmxvY2tzXG4gICAgICAgIGxldCByZW1vdmVfYmxvY2sgPSAvXHUyNkQ0XFxzW1xcdyxdK1sgXFx0XSovZztcbiAgICAgICAgc2VsID0gc2VsLnJlcGxhY2VBbGwocmVtb3ZlX2Jsb2NrLCAnJyk7XG5cbiAgICAgICAgLy8gUmVtb3ZlIGV4aXN0aW5nIHRhZ3NcbiAgICAgICAgaWYgKGNsZWFyX2FsbF90YWdzKSB7XG4gICAgICAgICAgICBsZXQgcmVtb3ZlX3RhZyA9IG5ldyBSZWdFeHAoXCJeKFxcXFxzKi1cXFxcc1xcXFxbWyB4XFxcXC1cXFxcL11cXF1cXFxccy4qPykoI1xcXFx3KykoXFxcXHMrI1xcXFx3K1xccyopKiguKikkXCIsIFwibWdcIik7O1xuICAgICAgICAgICAgc2VsID0gc2VsLnJlcGxhY2VBbGwocmVtb3ZlX3RhZywgJyQxJDQnKTtcbiAgICAgICAgfSBlbHNlIGlmIChhdXRvbWF0aWNfdGFnKSB7XG4gICAgICAgICAgICBsZXQgcmVtb3ZlX3RhZyA9IG5ldyBSZWdFeHAoXCJeKFxcXFxzKi1cXFxcc1xcXFxbWyB4XFxcXC1cXFxcL11cXF1cXFxccy4qKSgjXCIgKyBhdXRvbWF0aWNfdGFnICsgXCIpKC4qKSRcIiwgXCJtZ1wiKTtcbiAgICAgICAgICAgIHNlbCA9IHNlbC5yZXBsYWNlQWxsKHJlbW92ZV90YWcsICckMSAkMycpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlbDtcbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0QmxvY2tFbmQoZWRpdG9yOiBTaW1wbGVFZGl0b3IpIHtcbiAgICAgICAgLy8gRmluZCB0aGUgZW5kIG9mIHRoZSBibG9ja1xuICAgICAgICBsZXQgYmxvY2tFbmQgPSBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZTtcbiAgICAgICAgaWYgKGJsb2NrRW5kID49IGVkaXRvci5saW5lQ291bnQoKSAtIDEpIHJldHVybiBibG9ja0VuZCArIDE7XG4gICAgICAgIGJsb2NrRW5kICs9IDE7XG4gICAgICAgIHdoaWxlICghQkxPQ0tfQk9VTkRBUlkudGVzdChlZGl0b3IuZ2V0TGluZShibG9ja0VuZCkpKSB7XG4gICAgICAgICAgICBibG9ja0VuZCsrO1xuICAgICAgICAgICAgaWYgKGJsb2NrRW5kID4gZWRpdG9yLmxpbmVDb3VudCgpIC0gMSkgcmV0dXJuIGJsb2NrRW5kO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBibG9ja0VuZDtcbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0QmxvY2tTdGFydChlZGl0b3I6IFNpbXBsZUVkaXRvcikge1xuICAgICAgICAvLyBGaW5kIHRoZSBzdGFydCBvZiB0aGUgYmxvY2tcbiAgICAgICAgbGV0IGJsb2NrU3RhcnQgPSBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZTtcbiAgICAgICAgaWYgKEJMT0NLX0JPVU5EQVJZLnRlc3QoZWRpdG9yLmdldExpbmUoYmxvY2tTdGFydCkpKSB7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5taW4oZWRpdG9yLmxpbmVDb3VudCgpIC0xLCBibG9ja1N0YXJ0ICsgMSk7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKGJsb2NrU3RhcnQgPiAwICYmICFCTE9DS19CT1VOREFSWS50ZXN0KGVkaXRvci5nZXRMaW5lKGJsb2NrU3RhcnQgLSAxKSkpIHtcbiAgICAgICAgICAgIGJsb2NrU3RhcnQtLTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYmxvY2tTdGFydDtcbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0QWxsQmxvY2tTdGFydHMoZWRpdG9yOiBTaW1wbGVFZGl0b3IpIHtcbiAgICAgICAgLy8gUmV0dXJuIGFsbCB0aGUgbGluZXMgdGhhdCBtYXJrIHRoZSBzdGFydCBvZiBhIGJsb2NrIGluIGEgZmlsZVxuICAgICAgICBsZXQgYmxvY2tzID0gWzBdO1xuICAgICAgICBsZXQgc2VjdGlvbiA9IC9eIz9cXHNcXHcrL1xuICAgICAgICBmb3IgKGxldCBsaW5lX251bWJlciA9IDA7IGxpbmVfbnVtYmVyIDwgZWRpdG9yLmxpbmVDb3VudCgpOyBsaW5lX251bWJlcisrKSB7XG4gICAgICAgICAgICBpZiAoc2VjdGlvbi50ZXN0KGVkaXRvci5nZXRMaW5lKGxpbmVfbnVtYmVyKSkpIHtcbiAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2Ugd2hlbiB0aGUgZmlyc3QgbGluZSBpcyBhIHNlY3Rpb24gd2UgZG9uJ3QgaGF2ZSB0byBhZGQgaXRcbiAgICAgICAgICAgICAgICBpZiAobGluZV9udW1iZXIgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2Nrcy5wdXNoKGxpbmVfbnVtYmVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYmxvY2tzO1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXRTZWN0aW9uTmFtZShlZGl0b3I6IFNpbXBsZUVkaXRvciwgZmlsZV9uYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgbGV0IHNlY3Rpb25fc3RhcnQgPSBIZWxwZXIuZ2V0QmxvY2tTdGFydChlZGl0b3IpO1xuICAgICAgICBpZiAoc2VjdGlvbl9zdGFydCA9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlsZV9uYW1lXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZWRpdG9yLmdldExpbmUoc2VjdGlvbl9zdGFydC0xKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHN0YXRpYyBhZGRUYXNrSURzKHNlbDogc3RyaW5nLCBwcmVmaXg6IHN0cmluZywgYXV0b21hdGljX3RhZzogc3RyaW5nLCBwYXJhbGxlbDogYm9vbGVhbiwgdXNlX3ByZWZpeDogYm9vbGVhbixcbiAgICAgICAgICAgICAgICAgICAgICByYW5kb21faWRfbGVuZ3RoOiBudW1iZXIsIHNlcXVlbnRpYWxfc3RhcnQ6IG51bWJlcikge1xuICAgICAgICBjb25zdCByZWdleCA9IC9eKFxccyotXFxzXFxbWyB4XFwtXFwvXVxcXVxccyk/KC4qKSQvbWc7XG5cbiAgICAgICAgLy8gQ2xlYXIgYWxsIHRoZSBleGlzdGluZyBibG9jayBhbmQgcHJvamVjdCBJRCdzXG4gICAgICAgIHNlbCA9IEhlbHBlci5jbGVhckJsb2NrSURzKHNlbCwgYXV0b21hdGljX3RhZyk7XG5cbiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmxvZyhgUmVwbGFjZWQgaWRzIGFuZCBibG9ja3MgdG8gZ2l2ZTogJHtzZWx9YCk7XG5cbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHNlbC5tYXRjaEFsbChyZWdleCk7XG4gICAgICAgIGxldCBsaW5lcyA9IFwiXCI7XG4gICAgICAgIGxldCBmaXJzdCA9IHRydWU7XG4gICAgICAgIGxldCBpZHggPSAwO1xuICAgICAgICBsZXQgbmVzdGluZ19pZHMgPSBbXCIwOkVSUk9SIVwiXTtcbiAgICAgICAgbGV0IGN1cnJlbnRfbmVzdGluZyA9IDA7XG4gICAgICAgIGxldCBpc19wYXJhbGxlbCA9IGZhbHNlO1xuICAgICAgICBsZXQgdGhpc19pZDtcblxuICAgICAgICAvLyBHbyB0aHJvdWdoIGFsbCB0aGUgbGluZXMgYW5kIGFkZCBhcHByb3ByaWF0ZSBJRCBhbmQgYmxvY2sgdGFnc1xuICAgICAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIG1hdGNoZXMpIHtcbiAgICAgICAgICAgIGlmICghZmlyc3QpIHtcbiAgICAgICAgICAgICAgICBsaW5lcyArPSBcIlxcblwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSXMgdGhpcyBhIHRhc2sgbGluZSBhdCBhbGw/XG4gICAgICAgICAgICBpZiAobWF0Y2hbMV0pIHtcbiAgICAgICAgICAgICAgICAvLyBXYXRjaCBvdXQgZm9yIGNoYW5nZXMgaW4gbmVzdGluZ1xuICAgICAgICAgICAgICAgIGlmIChwYXJhbGxlbCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbmVzdGluZ19kZXB0aCA9IEhlbHBlci5nZXROZXN0aW5nTGV2ZWwobWF0Y2hbMV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAobmVzdGluZ19kZXB0aCA+IGN1cnJlbnRfbmVzdGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGEgbmV3IGxldmVsIG9mIG5lc3RpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfbmVzdGluZyArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNfcGFyYWxsZWwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmVzdGluZ19pZHMucHVzaChgYCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobmVzdGluZ19kZXB0aCA8IGN1cnJlbnRfbmVzdGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGxldmVscyBvZiBuZXN0aW5nXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoY3VycmVudF9uZXN0aW5nID4gbmVzdGluZ19kZXB0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfbmVzdGluZyAtPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZXN0ZWQgPSBuZXN0aW5nX2lkcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmVzdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5lc3RpbmdfaWRzW25lc3RpbmdfaWRzLmxlbmd0aCAtIDFdICs9IGAsJHtuZXN0ZWR9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNfcGFyYWxsZWwgPSBjdXJyZW50X25lc3RpbmcgPiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCB0aGlzX2xpbmU7XG4gICAgICAgICAgICAgICAgLy8gR2V0IGFuIGlkIHRvIHVzZVxuICAgICAgICAgICAgICAgIGlmICh1c2VfcHJlZml4KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNfaWQgPSBgJHtwcmVmaXh9JHtIZWxwZXIuZ2VuZXJhdGVSYW5kb21EaWdpdHMocmFuZG9tX2lkX2xlbmd0aCl9YDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzX2lkID0gYCR7cHJlZml4fSR7aWR4ICsgc2VxdWVudGlhbF9zdGFydH1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIGlkIGludG8gdGhlcmVcbiAgICAgICAgICAgICAgICBsZXQgY2xlYW5lZF9saW5lID0gbWF0Y2hbMl0udHJpbSgpO1xuICAgICAgICAgICAgICAgIC8vIEFkZCBhIHNwYWNlIGF0IHRoZSBlbmQgaWYgbmVlZGVkXG4gICAgICAgICAgICAgICAgaWYgKGNsZWFuZWRfbGluZSAhPSBcIlwiKSBjbGVhbmVkX2xpbmUgKz0gXCIgXCI7XG4gICAgICAgICAgICAgICAgdGhpc19saW5lID0gYCR7bWF0Y2hbMV19JHtjbGVhbmVkX2xpbmV9XHVEODNDXHVERDk0ICR7dGhpc19pZH1gO1xuICAgICAgICAgICAgICAgIGlmIChpZHggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgYmxvY2tzIGFmdGVyIHRoZSB2ZXJ5IGZpcnN0IHRhc2tcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzX3BhcmFsbGVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzX2xpbmUgKz0gYCBcdTI2RDQgJHtuZXN0aW5nX2lkc1tjdXJyZW50X25lc3RpbmcgLSAxXX1gO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc19saW5lICs9IGAgXHUyNkQ0ICR7bmVzdGluZ19pZHNbbmVzdGluZ19pZHMubGVuZ3RoIC0gMV19YDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEFkZCBhbiBhdXRvbWF0aWMgdGFnIGlmIHdlIG5lZWQgaXRcbiAgICAgICAgICAgICAgICBpZiAoYXV0b21hdGljX3RhZykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzX2xpbmUgKz0gYCAjJHthdXRvbWF0aWNfdGFnfWA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQXBwZW5kIHRoaXMgbGluZVxuICAgICAgICAgICAgICAgIGxpbmVzICs9IHRoaXNfbGluZTtcbiAgICAgICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgICAgICAgICBpZiAoaXNfcGFyYWxsZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5lc3RpbmdfaWRzW25lc3RpbmdfaWRzLmxlbmd0aCAtIDFdKSBuZXN0aW5nX2lkc1tuZXN0aW5nX2lkcy5sZW5ndGggLSAxXSArPSBcIixcIjtcbiAgICAgICAgICAgICAgICAgICAgbmVzdGluZ19pZHNbbmVzdGluZ19pZHMubGVuZ3RoIC0gMV0gKz0gYCR7dGhpc19pZH1gO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5lc3RpbmdfaWRzW25lc3RpbmdfaWRzLmxlbmd0aCAtIDFdID0gdGhpc19pZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmxvZyhgTmVzdGluZyBsZXZlbCAke2N1cnJlbnRfbmVzdGluZ30sIGlkcyAke25lc3RpbmdfaWRzfWApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBOb3QgYSB0YXNrIGxpbmUgc28ganVzdCBrZWVwIGl0IGFzIGlzXG4gICAgICAgICAgICAgICAgbGluZXMgKz0gYCR7bWF0Y2hbMl19YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpcnN0ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxpbmVzO1xuICAgIH1cblxuICAgIHN0YXRpYyBwYXJzZUxpbmUobGluZTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gL14oXFxzKi1cXHNcXFsoWyB4XFwtXFwvXSlcXF1cXHMpPyguKikkLztcbiAgICAgICAgbGV0IG1hdGNoID0gcmVnZXguZXhlYyhsaW5lKTtcbiAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAvLyBXYXMgYW4gZXhwZWN0ZWQgbGluZVxuICAgICAgICAgICAgaWYgKG1hdGNoWzFdKSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHRhc2sgbGluZVxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUGFyc2VkTGluZSh0cnVlLCBtYXRjaFsyXSwgbWF0Y2hbM10sIHRoaXMuZ2V0TmVzdGluZ0xldmVsKGxpbmUpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBpc24ndCBhIHRhc2sgbGluZVxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUGFyc2VkTGluZShmYWxzZSwgJycsIG1hdGNoWzNdLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFNvbWV0aGluZyB3ZW50IHdyb25nIGhlcmVcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTGluZSB3YXMgbm90IHVuZGVyc3Rvb2Q6IFwiJHtsaW5lfVwiYCk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBV087OztBQ1JQLElBQU0saUJBQWlCO0FBQ3ZCLElBQU0sUUFBUTtBQWFkLElBQU0sYUFBTixNQUFpQjtBQUFBLEVBTWIsWUFBWSxTQUFrQixhQUFxQixXQUFtQixTQUFpQjtBQUNuRixTQUFLLFVBQVU7QUFDZixTQUFLLGNBQWM7QUFDbkIsU0FBSyxZQUFZO0FBQ2pCLFNBQUssVUFBVTtBQUFBLEVBQ25CO0FBQ0o7QUFFQSxJQUFxQixTQUFyQixNQUE0QjtBQUFBO0FBQUE7QUFBQSxFQUd4QixjQUFjO0FBQUEsRUFDZDtBQUFBLEVBRUEsT0FBTyxnQkFBZ0IsYUFBNkI7QUFFaEQsUUFBSSxRQUFRLFlBQVksV0FBVyxNQUFNLEVBQUUsRUFBRSxNQUFNLEdBQUc7QUFDdEQsV0FBTyxNQUFNLENBQUMsRUFBRTtBQUFBLEVBQ3BCO0FBQUEsRUFFQSxPQUFPLHFCQUFxQixRQUF3QjtBQUNsRCxVQUFNLFNBQVM7QUFDZixRQUFJLGVBQWU7QUFFbkIsYUFBUyxJQUFJLEdBQUcsSUFBSSxRQUFRLEtBQUs7QUFDL0IsWUFBTSxjQUFjLEtBQUssTUFBTSxLQUFLLE9BQU8sSUFBSSxPQUFPLE1BQU07QUFDNUQsc0JBQWdCLE9BQU8sV0FBVztBQUFBLElBQ3BDO0FBRUEsV0FBTztBQUFBLEVBQ1Q7QUFBQSxFQUVBLE9BQU8sb0JBQW9CLE1BQWMsZUFBd0IsZUFBd0I7QUFFckYsV0FBTyxLQUFLLFdBQVcsWUFBWSxFQUFFO0FBRXJDLFFBQUksUUFBUSxLQUFLLE1BQU0sS0FBSztBQUM1QixXQUFPO0FBQ1AsYUFBUyxRQUFRLE9BQU87QUFDcEIsVUFBSSxNQUFNO0FB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
