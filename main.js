/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ProjectTasks
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  idPrefixMethod: "1" /* UsePrefix */,
  projectPrefix: "prj"
};
var ProjectTasks = class extends import_obsidian.Plugin {
  async onload() {
    console.log("Project Tasks starting");
    await this.loadSettings();
    this.addCommand({
      id: "set-ids",
      name: "Set project ids on Selection",
      editorCallback: (editor, view) => {
        let sel = editor.getSelection();
        let lines = this.addTaskIDs(sel);
        new import_obsidian.Notice(`Project tasks created from: ${sel}`);
        editor.replaceSelection(
          `${lines}`
        );
      }
    });
    this.addCommand({
      id: "clear-ids",
      name: "Clear project ids on Selection",
      editorCallback: (editor, view) => {
        let sel = editor.getSelection();
        let lines = this.clearBlockIDs(sel);
        new import_obsidian.Notice(`Project tasks cleared from: ${sel}`);
        editor.replaceSelection(
          `${lines}`
        );
      }
    });
    this.addCommand({
      id: "set-ids-block",
      name: "Set project ids on Block",
      editorCallback: (editor, view) => {
        this.blockUpdate(editor, true);
      }
    });
    this.addCommand({
      id: "clear-ids-block",
      name: "Clear project ids on Block",
      editorCallback: (editor, view) => {
        this.blockUpdate(editor, false);
      }
    });
    this.addSettingTab(new SampleSettingTab(this.app, this));
    this.registerInterval(window.setInterval(() => console.log("setInterval"), 5 * 60 * 1e3));
  }
  blockUpdate(editor, add_ids) {
    const cursor = editor.getCursor();
    const line = editor.getLine(cursor.line);
    const block_boundary = /^#+\s/;
    let blockStart = this.getBlockStart(cursor, block_boundary, editor);
    let blockEnd = this.getBlockEnd(cursor, editor, block_boundary);
    const blockContent = editor.getRange({ line: blockStart, ch: 0 }, { line: blockEnd, ch: line.length });
    console.log(`The block is: ${blockContent}`);
    let lines;
    if (add_ids) {
      lines = this.addTaskIDs(blockContent);
    } else {
      lines = this.clearBlockIDs(blockContent);
    }
    let last_line_length = editor.getLine(blockEnd).length;
    editor.replaceRange(lines, { line: blockStart, ch: 0 }, { line: blockEnd, ch: last_line_length });
  }
  getBlockEnd(cursor, editor, block_boundary) {
    let blockEnd = cursor.line;
    while (blockEnd < editor.lineCount() - 1 && !block_boundary.test(editor.getLine(blockEnd + 1))) {
      blockEnd++;
    }
    return blockEnd;
  }
  getBlockStart(cursor, block_boundary, editor) {
    let blockStart = cursor.line;
    while (blockStart > 0 && !block_boundary.test(editor.getLine(blockStart - 1))) {
      blockStart--;
    }
    return blockStart;
  }
  clearBlockIDs(sel) {
    let remove_id = /\h?ðŸ†”\s\w+\h*/g;
    sel = sel.replaceAll(remove_id, "");
    let remove_block = /\h?â›”\s\w+\h*/g;
    sel = sel.replaceAll(remove_block, "");
    return sel;
  }
  getPrefix() {
    return this.settings.projectPrefix;
  }
  addTaskIDs(sel) {
    const regex = /^(-\s\[[ x\-\/]\]\s)?(.*)$/mg;
    sel = this.clearBlockIDs(sel);
    console.log(`Replaced ids and blocks to give: ${sel}`);
    const matches = sel.matchAll(regex);
    let lines = "";
    let first = true;
    let idx = 0;
    const prefix = this.getPrefix();
    for (const match of matches) {
      if (!first) {
        lines += "\n";
      }
      if (match[1]) {
        lines += `${match[1]}${match[2].trim()} \u{1F194} ${prefix}${idx}`;
        if (idx > 0) {
          lines += ` \u26D4 ${prefix}${idx - 1}`;
        }
        idx += 1;
      } else {
        lines += `${match[2].trim()}`;
      }
      first = false;
    }
    return lines;
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var SampleSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Project ID method").setDesc("Choose how the ID will be determined").addDropdown((dropDown) => {
      dropDown.addOption("1", "Use prefix");
      dropDown.addOption("2", "Use Section name");
      dropDown.addOption("3", "Use filename").setValue(this.plugin.settings.idPrefixMethod).onChange(async (value) => {
        this.plugin.settings.idPrefixMethod = value;
        console.log(`Set to ${value}, ${this.plugin.settings.idPrefixMethod}`);
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Project ID prefix").setDesc("Prefix to use when creating an ID for a task").addText((text) => text.setPlaceholder("ID prefix").setValue(this.plugin.settings.projectPrefix).onChange(async (value) => {
      this.plugin.settings.projectPrefix = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtBcHAsIEVkaXRvciwgRWRpdG9yUG9zaXRpb24sIE1hcmtkb3duVmlldywgTW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nfSBmcm9tICdvYnNpZGlhbic7XG5cbi8vIFJlbWVtYmVyIHRvIHJlbmFtZSB0aGVzZSBjbGFzc2VzIGFuZCBpbnRlcmZhY2VzISFcblxuZW51bSBQcmVmaXhNZXRob2Qge1xuICAgIFVzZVByZWZpeD0gJzEnLFxuICAgIFNlY3Rpb25OYW1lID0gJzInLFxuICAgIEZpbGVOYW1lID0gJzMnXG59XG5cbmludGVyZmFjZSBNeVBsdWdpblNldHRpbmdzIHtcbiAgICBpZFByZWZpeE1ldGhvZDogUHJlZml4TWV0aG9kO1xuICAgIHByb2plY3RQcmVmaXg6IHN0cmluZztcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTXlQbHVnaW5TZXR0aW5ncyA9IHtcbiAgICBpZFByZWZpeE1ldGhvZDogUHJlZml4TWV0aG9kLlVzZVByZWZpeCxcbiAgICBwcm9qZWN0UHJlZml4OiAncHJqJ1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQcm9qZWN0VGFza3MgZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBNeVBsdWdpblNldHRpbmdzO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnUHJvamVjdCBUYXNrcyBzdGFydGluZycpO1xuXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcInNldC1pZHNcIixcbiAgICAgICAgICAgIG5hbWU6IFwiU2V0IHByb2plY3QgaWRzIG9uIFNlbGVjdGlvblwiLFxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3IsIHZpZXcpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgc2VsID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGxldCBsaW5lcyA9IHRoaXMuYWRkVGFza0lEcyhzZWwpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFByb2plY3QgdGFza3MgY3JlYXRlZCBmcm9tOiAke3NlbH1gKTtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVNlbGVjdGlvbihcbiAgICAgICAgICAgICAgICAgICAgYCR7bGluZXN9YFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogXCJjbGVhci1pZHNcIixcbiAgICAgICAgICAgIG5hbWU6IFwiQ2xlYXIgcHJvamVjdCBpZHMgb24gU2VsZWN0aW9uXCIsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvciwgdmlldykgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBzZWwgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgbGV0IGxpbmVzID0gdGhpcy5jbGVhckJsb2NrSURzKHNlbCk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgUHJvamVjdCB0YXNrcyBjbGVhcmVkIGZyb206ICR7c2VsfWApO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKFxuICAgICAgICAgICAgICAgICAgICBgJHtsaW5lc31gXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcInNldC1pZHMtYmxvY2tcIixcbiAgICAgICAgICAgIG5hbWU6IFwiU2V0IHByb2plY3QgaWRzIG9uIEJsb2NrXCIsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvciwgdmlldykgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYmxvY2tVcGRhdGUoZWRpdG9yLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwiY2xlYXItaWRzLWJsb2NrXCIsXG4gICAgICAgICAgICBuYW1lOiBcIkNsZWFyIHByb2plY3QgaWRzIG9uIEJsb2NrXCIsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvciwgdmlldykgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYmxvY2tVcGRhdGUoZWRpdG9yLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8gVGhpcyBhZGRzIGEgc2V0dGluZ3MgdGFiIHNvIHRoZSB1c2VyIGNhbiBjb25maWd1cmUgdmFyaW91cyBhc3BlY3RzIG9mIHRoZSBwbHVnaW5cbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBTYW1wbGVTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cbiAgICAgICAgLy8gV2hlbiByZWdpc3RlcmluZyBpbnRlcnZhbHMsIHRoaXMgZnVuY3Rpb24gd2lsbCBhdXRvbWF0aWNhbGx5IGNsZWFyIHRoZSBpbnRlcnZhbCB3aGVuIHRoZSBwbHVnaW4gaXMgZGlzYWJsZWQuXG4gICAgICAgIHRoaXMucmVnaXN0ZXJJbnRlcnZhbCh3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4gY29uc29sZS5sb2coJ3NldEludGVydmFsJyksIDUgKiA2MCAqIDEwMDApKTtcblxuXG4gICAgfVxuXG4gICAgYmxvY2tVcGRhdGUoZWRpdG9yOiBFZGl0b3IsIGFkZF9pZHM6IGJvb2xlYW4pIHtcbiAgICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICBjb25zdCBsaW5lID0gZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpO1xuXG4gICAgICAgIC8vIFJlZ2V4IGZvciBibG9jayBib3VuZGFyeVxuICAgICAgICBjb25zdCBibG9ja19ib3VuZGFyeSA9IC9eIytcXHMvO1xuXG4gICAgICAgIC8vIEdldCB0aGUgYmxvY2sgYm91bmRhcmllc1xuICAgICAgICBsZXQgYmxvY2tTdGFydCA9IHRoaXMuZ2V0QmxvY2tTdGFydChjdXJzb3IsIGJsb2NrX2JvdW5kYXJ5LCBlZGl0b3IpO1xuICAgICAgICBsZXQgYmxvY2tFbmQgPSB0aGlzLmdldEJsb2NrRW5kKGN1cnNvciwgZWRpdG9yLCBibG9ja19ib3VuZGFyeSk7XG5cbiAgICAgICAgY29uc3QgYmxvY2tDb250ZW50ID0gZWRpdG9yLmdldFJhbmdlKHsgbGluZTogYmxvY2tTdGFydCwgY2g6IDAgfSwgeyBsaW5lOiBibG9ja0VuZCwgY2g6IGxpbmUubGVuZ3RoIH0pO1xuICAgICAgICBjb25zb2xlLmxvZyhgVGhlIGJsb2NrIGlzOiAke2Jsb2NrQ29udGVudH1gKTtcblxuICAgICAgICBsZXQgbGluZXM7XG4gICAgICAgIGlmIChhZGRfaWRzKSB7XG4gICAgICAgICAgICBsaW5lcyA9IHRoaXMuYWRkVGFza0lEcyhibG9ja0NvbnRlbnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGluZXMgPSB0aGlzLmNsZWFyQmxvY2tJRHMoYmxvY2tDb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbGFzdF9saW5lX2xlbmd0aCA9IGVkaXRvci5nZXRMaW5lKGJsb2NrRW5kKS5sZW5ndGg7XG4gICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobGluZXMsIHsgbGluZTogYmxvY2tTdGFydCwgY2g6IDAgfSwgeyBsaW5lOiBibG9ja0VuZCwgY2g6IGxhc3RfbGluZV9sZW5ndGggfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRCbG9ja0VuZChjdXJzb3I6IEVkaXRvclBvc2l0aW9uLCBlZGl0b3I6IEVkaXRvciwgYmxvY2tfYm91bmRhcnk6IFJlZ0V4cCkge1xuICAgICAgICAvLyBGaW5kIHRoZSBlbmQgb2YgdGhlIGJsb2NrXG4gICAgICAgIGxldCBibG9ja0VuZCA9IGN1cnNvci5saW5lO1xuICAgICAgICB3aGlsZSAoYmxvY2tFbmQgPCBlZGl0b3IubGluZUNvdW50KCkgLSAxICYmICFibG9ja19ib3VuZGFyeS50ZXN0KGVkaXRvci5nZXRMaW5lKGJsb2NrRW5kICsgMSkpKSB7XG4gICAgICAgICAgICBibG9ja0VuZCsrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBibG9ja0VuZDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldEJsb2NrU3RhcnQoY3Vyc29yOiBFZGl0b3JQb3NpdGlvbiwgYmxvY2tfYm91bmRhcnk6IFJlZ0V4cCwgZWRpdG9yOiBFZGl0b3IpIHtcbiAgICAgICAgLy8gRmluZCB0aGUgc3RhcnQgb2YgdGhlIGJsb2NrXG4gICAgICAgIGxldCBibG9ja1N0YXJ0ID0gY3Vyc29yLmxpbmU7XG4gICAgICAgIHdoaWxlIChibG9ja1N0YXJ0ID4gMCAmJiAhYmxvY2tfYm91bmRhcnkudGVzdChlZGl0b3IuZ2V0TGluZShibG9ja1N0YXJ0IC0gMSkpKSB7XG4gICAgICAgICAgICBibG9ja1N0YXJ0LS07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJsb2NrU3RhcnQ7XG4gICAgfVxuXG4gICAgY2xlYXJCbG9ja0lEcyhzZWw6IHN0cmluZykge1xuICAgICAgICAvLyBSZW1vdmUgZXhpc3RpbmcgSUQnc1xuICAgICAgICBsZXQgcmVtb3ZlX2lkID0gL1xcaD9cdUQ4M0NcdUREOTRcXHNcXHcrXFxoKi9nO1xuICAgICAgICBzZWwgPSBzZWwucmVwbGFjZUFsbChyZW1vdmVfaWQsICcnKTtcblxuICAgICAgICAvLyBSZW1vdmUgZXhpc3RpbmcgQmxvY2tzXG4gICAgICAgIGxldCByZW1vdmVfYmxvY2sgPSAvXFxoP1x1MjZENFxcc1xcdytcXGgqL2c7XG4gICAgICAgIHNlbCA9IHNlbC5yZXBsYWNlQWxsKHJlbW92ZV9ibG9jaywgJycpO1xuXG4gICAgICAgIHJldHVybiBzZWw7XG4gICAgfVxuXG4gICAgZ2V0UHJlZml4KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5wcm9qZWN0UHJlZml4O1xuICAgIH1cblxuICAgIGFkZFRhc2tJRHMoc2VsOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgcmVnZXggPSAvXigtXFxzXFxbWyB4XFwtXFwvXVxcXVxccyk/KC4qKSQvbWc7XG5cbiAgICAgICAgLy8gQ2xlYXIgYWxsIHRoZSBleGlzdGluZyBibG9jayBhbmQgcHJvamVjdCBJRCdzXG4gICAgICAgIHNlbCA9IHRoaXMuY2xlYXJCbG9ja0lEcyhzZWwpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKGBSZXBsYWNlZCBpZHMgYW5kIGJsb2NrcyB0byBnaXZlOiAke3NlbH1gKTtcblxuICAgICAgICBjb25zdCBtYXRjaGVzID0gc2VsLm1hdGNoQWxsKHJlZ2V4KTtcbiAgICAgICAgbGV0IGxpbmVzID0gXCJcIjtcbiAgICAgICAgbGV0IGZpcnN0ID0gdHJ1ZTtcbiAgICAgICAgbGV0IGlkeCA9IDA7XG4gICAgICAgIGNvbnN0IHByZWZpeCA9IHRoaXMuZ2V0UHJlZml4KCk7XG5cbiAgICAgICAgLy8gR28gdGhyb3VnaCBhbGwgdGhlIGxpbmVzIGFuZCBhZGQgYXBwcm9wcmlhdGUgSUQgYW5kIGJsb2NrIHRhZ3NcbiAgICAgICAgZm9yIChjb25zdCBtYXRjaCBvZiBtYXRjaGVzKSB7XG4gICAgICAgICAgICBpZiAoIWZpcnN0KSB7XG4gICAgICAgICAgICAgICAgbGluZXMgKz0gXCJcXG5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIElzIHRoaXMgYSB0YXNrIGxpbmUgYXQgYWxsP1xuICAgICAgICAgICAgaWYgKG1hdGNoWzFdKSB7XG4gICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBpZCBpbnRvIHRoZXJlXG4gICAgICAgICAgICAgICAgbGluZXMgKz0gYCR7bWF0Y2hbMV19JHttYXRjaFsyXS50cmltKCl9IFx1RDgzQ1x1REQ5NCAke3ByZWZpeH0ke2lkeH1gO1xuICAgICAgICAgICAgICAgIGlmIChpZHggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgYmxvY2tzIGFmdGVyIHRoZSB2ZXJ5IGZpcnN0IHRhc2tcbiAgICAgICAgICAgICAgICAgICAgbGluZXMgKz0gYCBcdTI2RDQgJHtwcmVmaXh9JHtpZHggLSAxfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBOb3QgYSB0YXNrIGxpbmUgc28ganVzdCBrZWVwIGl0IGFzIGlzXG4gICAgICAgICAgICAgICAgbGluZXMgKz0gYCR7bWF0Y2hbMl0udHJpbSgpfWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaXJzdCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaW5lcztcbiAgICB9XG5cbiAgICBvbnVubG9hZCgpIHtcblxuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cbn1cblxuY2xhc3MgU2FtcGxlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHtjb250ZW50RWx9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLnNldFRleHQoJ1dvYWghJyk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgY29uc3Qge2NvbnRlbnRFbH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICB9XG59XG5cbmNsYXNzIFNhbXBsZVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IFByb2plY3RUYXNrcztcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFByb2plY3RUYXNrcykge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHtjb250YWluZXJFbH0gPSB0aGlzO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnUHJvamVjdCBJRCBtZXRob2QnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0Nob29zZSBob3cgdGhlIElEIHdpbGwgYmUgZGV0ZXJtaW5lZCcpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oZHJvcERvd24gPT4ge1xuICAgICAgICAgICAgICAgIGRyb3BEb3duLmFkZE9wdGlvbignMScsICdVc2UgcHJlZml4Jyk7XG4gICAgICAgICAgICAgICAgZHJvcERvd24uYWRkT3B0aW9uKCcyJywgJ1VzZSBTZWN0aW9uIG5hbWUnKTtcbiAgICAgICAgICAgICAgICBkcm9wRG93bi5hZGRPcHRpb24oJzMnLCAnVXNlIGZpbGVuYW1lJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaWRQcmVmaXhNZXRob2QpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pZFByZWZpeE1ldGhvZCA9IHZhbHVlIGFzIFByZWZpeE1ldGhvZDtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFNldCB0byAke3ZhbHVlfSwgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5pZFByZWZpeE1ldGhvZH1gKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSl9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdQcm9qZWN0IElEIHByZWZpeCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnUHJlZml4IHRvIHVzZSB3aGVuIGNyZWF0aW5nIGFuIElEIGZvciBhIHRhc2snKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdJRCBwcmVmaXgnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9qZWN0UHJlZml4KVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvamVjdFByZWZpeCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHNCQUEwRztBQWUxRyxJQUFNLG1CQUFxQztBQUFBLEVBQ3ZDLGdCQUFnQjtBQUFBLEVBQ2hCLGVBQWU7QUFDbkI7QUFFQSxJQUFxQixlQUFyQixjQUEwQyx1QkFBTztBQUFBLEVBRzdDLE1BQU0sU0FBUztBQUNYLFlBQVEsSUFBSSx3QkFBd0I7QUFFcEMsVUFBTSxLQUFLLGFBQWE7QUFFeEIsU0FBSyxXQUFXO0FB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
